

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>plottr.plot.base &mdash; Tools for Experiments Manual  documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> Tools for Experiments Manual
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../plottr/index.html">Plottr’s Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../labcore/index.html">Labcore’s Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../instrumentserver/index.html">Instrumentserver’s Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/index.html">API Index Page</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples/index.html">Examples and Guides</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Tools for Experiments Manual</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>plottr.plot.base</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for plottr.plot.base</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">``plottr.plot.base`` -- Contains the base classes for plotting nodes and widgets.</span>
<span class="sd">Everything in here is independent of actual plotting backend, and does not contain plotting commands.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span><span class="p">,</span> <span class="n">unique</span><span class="p">,</span> <span class="n">auto</span>
<span class="kn">from</span> <span class="nn">types</span> <span class="kn">import</span> <span class="n">TracebackType</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Type</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> \
    <span class="n">OrderedDict</span> <span class="k">as</span> <span class="n">OrderedDictType</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">..</span> <span class="kn">import</span> <span class="n">Signal</span><span class="p">,</span> <span class="n">Flowchart</span><span class="p">,</span> <span class="n">QtWidgets</span>
<span class="kn">from</span> <span class="nn">..data.datadict</span> <span class="kn">import</span> <span class="n">DataDictBase</span><span class="p">,</span> <span class="n">DataDict</span><span class="p">,</span> <span class="n">MeshgridDataDict</span>
<span class="kn">from</span> <span class="nn">..node</span> <span class="kn">import</span> <span class="n">Node</span><span class="p">,</span> <span class="n">linearFlowchart</span>
<span class="kn">from</span> <span class="nn">..utils</span> <span class="kn">import</span> <span class="n">LabeledOptions</span>

<span class="n">__author__</span> <span class="o">=</span> <span class="s1">&#39;Wolfgang Pfaff&#39;</span>
<span class="n">__license__</span> <span class="o">=</span> <span class="s1">&#39;MIT&#39;</span>


<div class="viewcode-block" id="PlotNode"><a class="viewcode-back" href="../../../api/plottr/plot.html#plottr.plot.base.PlotNode">[docs]</a><span class="k">class</span> <span class="nc">PlotNode</span><span class="p">(</span><span class="n">Node</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Basic Plot Node, derived from :class:`plottr.node.node.Node`.</span>

<span class="sd">    At the moment this doesn&#39;t do much besides passing data to the plotting widget.</span>
<span class="sd">    Data is just passed through.</span>
<span class="sd">    On receipt of new data, :attr:`newPlotData` is emitted.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nodeName</span> <span class="o">=</span> <span class="s1">&#39;Plot&#39;</span>

    <span class="c1">#: Signal emitted when :meth:`process` is called, with the data passed to</span>
    <span class="c1">#: it as argument.</span>
    <span class="n">newPlotData</span> <span class="o">=</span> <span class="n">Signal</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor for :class:`PlotNode`. &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotWidgetContainer</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s1">&#39;PlotWidgetContainer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="PlotNode.setPlotWidgetContainer"><a class="viewcode-back" href="../../../api/plottr/plot.html#plottr.plot.base.PlotNode.setPlotWidgetContainer">[docs]</a>    <span class="k">def</span> <span class="nf">setPlotWidgetContainer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">w</span><span class="p">:</span> <span class="s1">&#39;PlotWidgetContainer&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the plot widget container.</span>

<span class="sd">        Makes sure that newly arriving data is sent to plot GUI elements.</span>

<span class="sd">        :param w: container to connect the node to.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotWidgetContainer</span> <span class="o">=</span> <span class="n">w</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">newPlotData</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotWidgetContainer</span><span class="o">.</span><span class="n">setData</span><span class="p">)</span></div>

<div class="viewcode-block" id="PlotNode.process"><a class="viewcode-back" href="../../../api/plottr/plot.html#plottr.plot.base.PlotNode.process">[docs]</a>    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataIn</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DataDictBase</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DataDictBase</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Emits the :attr:`newPlotData` signal when called.</span>
<span class="sd">        Note: does not call the parent method :meth:`plottr.node.node.Node.process`.</span>

<span class="sd">        :param dataIn: input data</span>
<span class="sd">        :returns: input data as is: ``{dataOut: dataIn}``</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">newPlotData</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">dataIn</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">dataOut</span><span class="o">=</span><span class="n">dataIn</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="PlotWidgetContainer"><a class="viewcode-back" href="../../../api/plottr/plot.html#plottr.plot.base.PlotWidgetContainer">[docs]</a><span class="k">class</span> <span class="nc">PlotWidgetContainer</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QWidget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This is the base widget for Plots, derived from `QWidget`.</span>

<span class="sd">    This widget does not implement any plotting. It merely is a wrapping</span>
<span class="sd">    widget that contains the actual plot widget in it. This actual plot</span>
<span class="sd">    widget can be set dynamically.</span>

<span class="sd">    Use :class:`PlotWidget` as base for implementing widgets that can be</span>
<span class="sd">    added to this container.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QWidget</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Constructor for :class:`PlotWidgetContainer`. &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plotWidget</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;PlotWidget&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DataDictBase</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">layout</span><span class="p">:</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QVBoxLayout</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QVBoxLayout</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">layout</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">layout</span><span class="p">)</span>

<div class="viewcode-block" id="PlotWidgetContainer.setPlotWidget"><a class="viewcode-back" href="../../../api/plottr/plot.html#plottr.plot.base.PlotWidgetContainer.setPlotWidget">[docs]</a>    <span class="k">def</span> <span class="nf">setPlotWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">widget</span><span class="p">:</span> <span class="s2">&quot;PlotWidget&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set the plot widget.</span>

<span class="sd">        Makes sure that the added widget receives new data.</span>

<span class="sd">        :param widget: plot widget</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># TODO: disconnect everything, make sure old widget is garbage collected</span>

        <span class="k">if</span> <span class="n">widget</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotWidget</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotWidget</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">removeWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotWidget</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotWidget</span><span class="o">.</span><span class="n">deleteLater</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plotWidget</span> <span class="o">=</span> <span class="n">widget</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotWidget</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">widget</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotWidget</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span></div>

<div class="viewcode-block" id="PlotWidgetContainer.setData"><a class="viewcode-back" href="../../../api/plottr/plot.html#plottr.plot.base.PlotWidgetContainer.setData">[docs]</a>    <span class="k">def</span> <span class="nf">setData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">DataDictBase</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;set Data. If a plot widget is defined, call the widget&#39;s</span>
<span class="sd">        :meth:`PlotWidget.setData` method.</span>

<span class="sd">        :param data: input data to be plotted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotWidget</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotWidget</span><span class="o">.</span><span class="n">setData</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="PlotWidget"><a class="viewcode-back" href="../../../api/plottr/plot.html#plottr.plot.base.PlotWidget">[docs]</a><span class="k">class</span> <span class="nc">PlotWidget</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QWidget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for Plot Widgets, this just defines the API. Derived from</span>
<span class="sd">    `QWidget`.</span>

<span class="sd">    Implement a child class for actual plotting.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">PlotWidgetContainer</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DataDictBase</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataType</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">DataDictBase</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataStructure</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DataDictBase</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataShapes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataLimits</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataChanges</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;dataTypeChanged&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s1">&#39;dataStructureChanged&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s1">&#39;dataShapesChanged&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s1">&#39;dataLimitsChanged&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">updatePlot</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

<div class="viewcode-block" id="PlotWidget.setData"><a class="viewcode-back" href="../../../api/plottr/plot.html#plottr.plot.base.PlotWidget.setData">[docs]</a>    <span class="k">def</span> <span class="nf">setData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DataDictBase</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Set data. Use this to trigger plotting.</span>

<span class="sd">        :param data: data to be plotted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataChanges</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyzeData</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></div>

<div class="viewcode-block" id="PlotWidget.analyzeData"><a class="viewcode-back" href="../../../api/plottr/plot.html#plottr.plot.base.PlotWidget.analyzeData">[docs]</a>    <span class="k">def</span> <span class="nf">analyzeData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DataDictBase</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;checks data and compares with previous properties.</span>

<span class="sd">        :param data: incoming data to compare to already existing data in the object.</span>
<span class="sd">        :return: dictionary with information on what has changed from previous to new data.</span>
<span class="sd">            contains key/value pairs where the key is the property analyzed, and the value is True of False. Keys are:</span>

<span class="sd">            * `dataTypeChanged` -- has the data class changed?</span>
<span class="sd">            * `dataStructureChanged` -- has the internal structure (data fields, etc) changed?</span>
<span class="sd">            * `dataShapesChanged` -- have the data fields changed shape?</span>
<span class="sd">            * `dataLimitsChanged` -- have the maxima/minima of the data fields changed?</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dataType</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="n">DataDictBase</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dataType</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dataStructure</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DataDictBase</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">dataShapes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">dataLimits</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dataStructure</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">structure</span><span class="p">(</span><span class="n">include_meta</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">dataShapes</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shapes</span><span class="p">()</span>
            <span class="n">dataLimits</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">axes</span><span class="p">()</span> <span class="o">+</span> <span class="n">data</span><span class="o">.</span><span class="n">dependents</span><span class="p">():</span>
                <span class="n">vals</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">data_vals</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
                <span class="n">dataLimits</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">vals</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">vals</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;dataTypeChanged&#39;</span><span class="p">:</span> <span class="n">dataType</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataType</span><span class="p">,</span>
            <span class="s1">&#39;dataStructureChanged&#39;</span><span class="p">:</span> <span class="n">dataStructure</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataStructure</span><span class="p">,</span>
            <span class="s1">&#39;dataShapesChanged&#39;</span><span class="p">:</span> <span class="n">dataShapes</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataShapes</span><span class="p">,</span>
            <span class="s1">&#39;dataLimitsChanged&#39;</span><span class="p">:</span> <span class="n">dataLimits</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataLimits</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dataType</span> <span class="o">=</span> <span class="n">dataType</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataStructure</span> <span class="o">=</span> <span class="n">dataStructure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataShapes</span> <span class="o">=</span> <span class="n">dataShapes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataLimits</span> <span class="o">=</span> <span class="n">dataLimits</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="PlotWidget.dataIsComplex"><a class="viewcode-back" href="../../../api/plottr/plot.html#plottr.plot.base.PlotWidget.dataIsComplex">[docs]</a>    <span class="k">def</span> <span class="nf">dataIsComplex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dependentName</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Determine whether our data is complex.</span>

<span class="sd">        :param dependentName: name of the dependent to check. if `None`, check all.</span>
<span class="sd">        :return: `True` if data is complex, `False` if not.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">dependentName</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dependents</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">issubsctype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_vals</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">complexfloating</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">issubsctype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">data_vals</span><span class="p">(</span><span class="n">dependentName</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">complexfloating</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="kc">False</span></div></div>


<div class="viewcode-block" id="makeFlowchartWithPlot"><a class="viewcode-back" href="../../../api/plottr/plot.html#plottr.plot.base.makeFlowchartWithPlot">[docs]</a><span class="k">def</span> <span class="nf">makeFlowchartWithPlot</span><span class="p">(</span><span class="n">nodes</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Type</span><span class="p">[</span><span class="n">Node</span><span class="p">]]],</span>
                          <span class="n">plotNodeName</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;plot&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Flowchart</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;create a linear FlowChart terminated with a plot node.</span>

<span class="sd">    :param nodes: List of Node classes, in the order they are to be arranged.</span>
<span class="sd">    :param plotNodeName: name of the plot node that will be appended.</span>
<span class="sd">    :return: the resulting FlowChart instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">plotNodeName</span><span class="p">,</span> <span class="n">PlotNode</span><span class="p">))</span>
    <span class="n">fc</span> <span class="o">=</span> <span class="n">linearFlowchart</span><span class="p">(</span><span class="o">*</span><span class="n">nodes</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fc</span></div>


<span class="c1"># Types of plots and plottable data</span>
<div class="viewcode-block" id="PlotDataType"><a class="viewcode-back" href="../../../api/plottr/plot.html#plottr.plot.base.PlotDataType">[docs]</a><span class="nd">@unique</span>
<span class="k">class</span> <span class="nc">PlotDataType</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Types of (plottable) data&quot;&quot;&quot;</span>

    <span class="c1">#: unplottable data</span>
    <span class="n">unknown</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>

    <span class="c1">#: scatter-type data with 1 dependent (data is not on a grid)</span>
    <span class="n">scatter1d</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>

    <span class="c1">#: line data with 1 dependent (data is on a grid)</span>
    <span class="n">line1d</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>

    <span class="c1">#: scatter data with 2 dependents (data is not on a grid)</span>
    <span class="n">scatter2d</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span>

    <span class="c1">#: grid data with 2 dependents</span>
    <span class="n">grid2d</span> <span class="o">=</span> <span class="n">auto</span><span class="p">()</span></div>


<div class="viewcode-block" id="ComplexRepresentation"><a class="viewcode-back" href="../../../api/plottr/plot.html#plottr.plot.base.ComplexRepresentation">[docs]</a><span class="k">class</span> <span class="nc">ComplexRepresentation</span><span class="p">(</span><span class="n">LabeledOptions</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Options for plotting complex-valued data.&quot;&quot;&quot;</span>

    <span class="c1">#: only real</span>
    <span class="n">real</span> <span class="o">=</span> <span class="s2">&quot;Real&quot;</span>

    <span class="c1">#: real and imaginary</span>
    <span class="n">realAndImag</span> <span class="o">=</span> <span class="s2">&quot;Real/Imag&quot;</span>

    <span class="c1">#: real and imaginary, separated</span>
    <span class="n">realAndImagSeparate</span> <span class="o">=</span> <span class="s2">&quot;Real/Imag (split)&quot;</span>

    <span class="c1">#: magnitude and phase</span>
    <span class="n">magAndPhase</span> <span class="o">=</span> <span class="s2">&quot;Mag/Phase&quot;</span></div>


<div class="viewcode-block" id="determinePlotDataType"><a class="viewcode-back" href="../../../api/plottr/plot.html#plottr.plot.base.determinePlotDataType">[docs]</a><span class="k">def</span> <span class="nf">determinePlotDataType</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DataDictBase</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">PlotDataType</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Analyze input data and determine most likely :class:`PlotDataType`.</span>

<span class="sd">    Analysis is simply based on number of dependents and data type.</span>

<span class="sd">    :param data: data to analyze.</span>
<span class="sd">    :return: type of plot data inferred</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO:</span>
    <span class="c1">#   there&#39;s probably ways to be more liberal about what can be plotted.</span>
    <span class="c1">#   like i can always make a 1d scatter...</span>

    <span class="c1"># a few things will result in unplottable data:</span>
    <span class="c1"># * wrong data format</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">DataDictBase</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">PlotDataType</span><span class="o">.</span><span class="n">unknown</span>

    <span class="c1"># * incompatible independents</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">axes_are_compatible</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">PlotDataType</span><span class="o">.</span><span class="n">unknown</span>

    <span class="c1"># * too few or too many independents</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">axes</span><span class="p">())</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">axes</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">PlotDataType</span><span class="o">.</span><span class="n">unknown</span>

    <span class="c1"># * no data to plot</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dependents</span><span class="p">())</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">PlotDataType</span><span class="o">.</span><span class="n">unknown</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">MeshgridDataDict</span><span class="p">):</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shapes</span><span class="p">()[</span><span class="n">data</span><span class="o">.</span><span class="n">dependents</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">axes</span><span class="p">())</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">PlotDataType</span><span class="o">.</span><span class="n">grid2d</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">PlotDataType</span><span class="o">.</span><span class="n">line1d</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">DataDict</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">axes</span><span class="p">())</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">PlotDataType</span><span class="o">.</span><span class="n">scatter2d</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">PlotDataType</span><span class="o">.</span><span class="n">scatter1d</span>

    <span class="k">return</span> <span class="n">PlotDataType</span><span class="o">.</span><span class="n">unknown</span></div>


<div class="viewcode-block" id="PlotItem"><a class="viewcode-back" href="../../../api/plottr/plot.html#plottr.plot.base.PlotItem">[docs]</a><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">PlotItem</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Data class describing a plot item in :class:`.AutoFigureMaker`.&quot;&quot;&quot;</span>
    <span class="c1">#: List of data arrays (independents and one dependent)</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">MaskedArray</span><span class="p">]]</span>
    <span class="c1">#: unique ID of the plot item</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span>
    <span class="c1">#: ID of the subplot the item will be plotted in</span>
    <span class="n">subPlot</span><span class="p">:</span> <span class="nb">int</span>
    <span class="c1">#: type of plot data (unknown is typically OK)</span>
    <span class="n">plotDataType</span><span class="p">:</span> <span class="n">PlotDataType</span> <span class="o">=</span> <span class="n">PlotDataType</span><span class="o">.</span><span class="n">unknown</span>
    <span class="c1">#: labels of the data arrays</span>
    <span class="n">labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1">#: options to be passed to plotting functions (depends on backend). Could be formatting options, for example.</span>
    <span class="n">plotOptions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1">#: return value from the plot command (like matplotlib Artists)</span>
    <span class="n">plotReturn</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="SubPlot"><a class="viewcode-back" href="../../../api/plottr/plot.html#plottr.plot.base.SubPlot">[docs]</a><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">SubPlot</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Data class describing a subplot in a :class:`.AutoFigureMaker`.&quot;&quot;&quot;</span>
    <span class="c1">#: ID of the subplot (unique per figure)</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span>
    <span class="c1">#: list of subplot objects (type depends on backend)</span>
    <span class="n">axes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="AutoFigureMaker"><a class="viewcode-back" href="../../../api/plottr/plot.html#plottr.plot.base.AutoFigureMaker">[docs]</a><span class="k">class</span> <span class="nc">AutoFigureMaker</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;A class for semi-automatic creation of plot figures.</span>
<span class="sd">    It must be inherited to tie it to a specific plotting backend.</span>

<span class="sd">    The main purpose of this class is to (a) implement actual plotting of</span>
<span class="sd">    plot items, and (b) distribute plot items correctly among subpanels of</span>
<span class="sd">    a figure.</span>

<span class="sd">    FigureMaker is a context manager. The user should eventually only need to</span>
<span class="sd">    add data and specify what kind of data it is. FigureMaker will then</span>
<span class="sd">    generate plots from that.</span>

<span class="sd">    In the simplest form, usage looks something like this::</span>

<span class="sd">        &gt;&gt;&gt; with AutoFigureMaker() as fm:</span>
<span class="sd">        &gt;&gt;&gt;     fm.addData(x, y, [...])</span>
<span class="sd">        &gt;&gt;&gt;     [...]</span>

<span class="sd">    See :meth:`addData` for details on how to specify data and how to pass</span>
<span class="sd">    plot options to it.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># TODO: implement feature for always plotting certain traces with other</span>
    <span class="c1">#   other ones (&#39;children&#39;). This is mainly used for models/fits.</span>
    <span class="c1">#   needs a system to copy certain style aspects from the parents.</span>
    <span class="c1"># TODO: similar, but with siblings (imagine Re/Im parts)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="c1">#: subplots to create</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subPlots</span><span class="p">:</span> <span class="n">OrderedDictType</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">SubPlot</span><span class="p">]</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>

        <span class="c1">#: items that will be plotted</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotItems</span><span class="p">:</span> <span class="n">OrderedDictType</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">PlotItem</span><span class="p">]</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>

        <span class="c1">#: ids of all main plot items (does not contain derived/secondary plot items)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotIds</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1">#: ids of all plot items, incl those who are &#39;joined&#39; with &#39;main&#39; plot items.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allPlotIds</span><span class="p">:</span> <span class="n">List</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1">#: how to represent complex data.</span>
        <span class="c1">#: must be set before adding data to the plot to have an effect.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">complexRepresentation</span><span class="p">:</span> <span class="n">ComplexRepresentation</span> <span class="o">=</span> <span class="n">ComplexRepresentation</span><span class="o">.</span><span class="n">realAndImag</span>

        <span class="c1">#: whether to combine 1D traces into one plot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">combineTraces</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;AutoFigureMaker&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Type</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">]],</span>
                 <span class="n">exc_value</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="ne">BaseException</span><span class="p">],</span>
                 <span class="n">traceback</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">TracebackType</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_makeAxes</span><span class="p">()</span>
        <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">subPlots</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_makeSubPlot</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>

    <span class="c1"># private methods</span>
    <span class="k">def</span> <span class="nf">_makeAxes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nSubPlots</span><span class="p">()</span>
        <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">axes</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">makeSubPlots</span><span class="p">(</span><span class="n">n</span><span class="p">)):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="n">axes</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">subPlots</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">SubPlot</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">axes</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_makeSubPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subPlotItems</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">item</span><span class="o">.</span><span class="n">plotReturn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">formatSubPlot</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_splitComplexData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plotItem</span><span class="p">:</span> <span class="n">PlotItem</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">PlotItem</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">plotItem</span><span class="o">.</span><span class="n">labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plotItem</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">plotItem</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">plotItem</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">issubsctype</span><span class="p">(</span><span class="n">plotItem</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">complexfloating</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">plotItem</span><span class="p">]</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">complexRepresentation</span> <span class="ow">is</span> <span class="n">ComplexRepresentation</span><span class="o">.</span><span class="n">real</span><span class="p">:</span>
            <span class="n">plotItem</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">plotItem</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">real</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">plotItem</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="n">plotItem</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Real&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plotItem</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">label</span> <span class="o">+</span> <span class="s1">&#39; (Real)&#39;</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">plotItem</span><span class="p">]</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">complexRepresentation</span> <span class="ow">in</span> \
                <span class="p">[</span><span class="n">ComplexRepresentation</span><span class="o">.</span><span class="n">realAndImag</span><span class="p">,</span> <span class="n">ComplexRepresentation</span><span class="o">.</span><span class="n">realAndImagSeparate</span><span class="p">]:</span>

            <span class="n">re_data</span> <span class="o">=</span> <span class="n">plotItem</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">real</span>
            <span class="n">im_data</span> <span class="o">=</span> <span class="n">plotItem</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span>

            <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="n">re_label</span><span class="p">,</span> <span class="n">im_label</span> <span class="o">=</span> <span class="s1">&#39;Real&#39;</span><span class="p">,</span> <span class="s1">&#39;Imag&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">re_label</span><span class="p">,</span> <span class="n">im_label</span> <span class="o">=</span> <span class="n">label</span> <span class="o">+</span> <span class="s1">&#39; (Real)&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">+</span> <span class="s1">&#39; (Imag)&#39;</span>

            <span class="n">re_plotItem</span> <span class="o">=</span> <span class="n">plotItem</span>
            <span class="n">im_plotItem</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">re_plotItem</span><span class="p">)</span>

            <span class="n">re_plotItem</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">re_data</span>
            <span class="n">im_plotItem</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">im_data</span>
            <span class="n">im_plotItem</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">re_plotItem</span><span class="o">.</span><span class="n">id</span> <span class="o">+</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">complexRepresentation</span> <span class="o">==</span> <span class="n">ComplexRepresentation</span><span class="o">.</span><span class="n">realAndImagSeparate</span> \
                    <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">plotItem</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">im_plotItem</span><span class="o">.</span><span class="n">subPlot</span> <span class="o">=</span> <span class="n">re_plotItem</span><span class="o">.</span><span class="n">subPlot</span> <span class="o">+</span> <span class="mi">1</span>

            <span class="c1"># this is a bit of a silly check (see top of the function -- should certainly be True!).</span>
            <span class="c1"># but it keeps mypy happy.</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">re_plotItem</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
            <span class="n">re_plotItem</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">re_label</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">im_plotItem</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
            <span class="n">im_plotItem</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">im_label</span>

            <span class="k">return</span> <span class="p">[</span><span class="n">re_plotItem</span><span class="p">,</span> <span class="n">im_plotItem</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>  <span class="c1"># means that self.complexRepresentation is ComplexRepresentation.magAndPhase:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">plotItem</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

            <span class="c1"># this check avoids a numpy ComplexWarning when we&#39;re working with MaskedArray (almost always)</span>
            <span class="n">mag_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">real</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">MaskedArray</span><span class="p">)</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">phase_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="n">mag_label</span><span class="p">,</span> <span class="n">phase_label</span> <span class="o">=</span> <span class="s1">&#39;Mag&#39;</span><span class="p">,</span> <span class="s1">&#39;Phase&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">mag_label</span><span class="p">,</span> <span class="n">phase_label</span> <span class="o">=</span> <span class="n">label</span> <span class="o">+</span> <span class="s1">&#39; (Mag)&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">+</span> <span class="s1">&#39; (Phase)&#39;</span>

            <span class="n">mag_plotItem</span> <span class="o">=</span> <span class="n">plotItem</span>
            <span class="n">phase_plotItem</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">mag_plotItem</span><span class="p">)</span>

            <span class="n">mag_plotItem</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">mag_data</span>
            <span class="n">phase_plotItem</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">phase_data</span>
            <span class="n">phase_plotItem</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">mag_plotItem</span><span class="o">.</span><span class="n">id</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">phase_plotItem</span><span class="o">.</span><span class="n">subPlot</span> <span class="o">=</span> <span class="n">mag_plotItem</span><span class="o">.</span><span class="n">subPlot</span> <span class="o">+</span> <span class="mi">1</span>

            <span class="c1"># this is a bit of a silly check (see top of the function -- should certainly be True!).</span>
            <span class="c1"># but it keeps mypy happy.</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mag_plotItem</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
            <span class="n">mag_plotItem</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">mag_label</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">phase_plotItem</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>
            <span class="n">phase_plotItem</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">phase_label</span>

            <span class="k">return</span> <span class="p">[</span><span class="n">mag_plotItem</span><span class="p">,</span> <span class="n">phase_plotItem</span><span class="p">]</span>

    <span class="c1"># public methods</span>
<div class="viewcode-block" id="AutoFigureMaker.addSubPlot"><a class="viewcode-back" href="../../../api/plottr/plot.html#plottr.plot.base.AutoFigureMaker.addSubPlot">[docs]</a>    <span class="k">def</span> <span class="nf">addSubPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add a new subplot.</span>

<span class="sd">        :return: ID of the new subplot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">id</span> <span class="o">=</span> <span class="n">_generate_auto_dict_key</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subPlots</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subPlots</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">SubPlot</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="p">[])</span>
        <span class="k">return</span> <span class="nb">id</span></div>

<div class="viewcode-block" id="AutoFigureMaker.nSubPlots"><a class="viewcode-back" href="../../../api/plottr/plot.html#plottr.plot.base.AutoFigureMaker.nSubPlots">[docs]</a>    <span class="k">def</span> <span class="nf">nSubPlots</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Count the subplots in the figure.</span>

<span class="sd">        :return: number of subplots</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotItems</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">subPlot</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">ids</span><span class="p">))</span></div>

<div class="viewcode-block" id="AutoFigureMaker.subPlotItems"><a class="viewcode-back" href="../../../api/plottr/plot.html#plottr.plot.base.AutoFigureMaker.subPlotItems">[docs]</a>    <span class="k">def</span> <span class="nf">subPlotItems</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subPlotId</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">OrderedDictType</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">PlotItem</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get items in a given subplot.</span>

<span class="sd">        :param subPlotId: ID of the subplot</span>
<span class="sd">        :return: Dictionary with all plot items and their ids.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">items</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotItems</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">subPlot</span> <span class="o">==</span> <span class="n">subPlotId</span><span class="p">:</span>
                <span class="n">items</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span>
        <span class="k">return</span> <span class="n">items</span></div>

<div class="viewcode-block" id="AutoFigureMaker.subPlotLabels"><a class="viewcode-back" href="../../../api/plottr/plot.html#plottr.plot.base.AutoFigureMaker.subPlotLabels">[docs]</a>    <span class="k">def</span> <span class="nf">subPlotLabels</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subPlotId</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Get the data labels for a given subplot.</span>

<span class="sd">        :param subPlotId: ID of the subplot.</span>
<span class="sd">        :return: a list with one element per plot item in the subplot.</span>
<span class="sd">            Each element contains a list of the labels for that item.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ret</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subPlotItems</span><span class="p">(</span><span class="n">subPlotId</span><span class="p">)</span>
        <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">labels</span><span class="p">):</span>
                    <span class="k">while</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ret</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="n">i</span><span class="p">:</span>
                        <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                    <span class="n">ret</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="AutoFigureMaker.addData"><a class="viewcode-back" href="../../../api/plottr/plot.html#plottr.plot.base.AutoFigureMaker.addData">[docs]</a>    <span class="k">def</span> <span class="nf">addData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">MaskedArray</span><span class="p">],</span>
                <span class="n">join</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">plotDataType</span><span class="p">:</span> <span class="n">PlotDataType</span> <span class="o">=</span> <span class="n">PlotDataType</span><span class="o">.</span><span class="n">unknown</span><span class="p">,</span>
                <span class="o">**</span><span class="n">plotOptions</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add data to the figure.</span>

<span class="sd">        :param data: data arrays describing the plot (one or more independents, one dependent)</span>
<span class="sd">        :param join: ID of a plot item the new item should be shown together with in the same subplot</span>
<span class="sd">        :param labels: list of labels for the data arrays</span>
<span class="sd">        :param plotDataType: what kind of plot data the supplied data contains.</span>
<span class="sd">        :param plotOptions: options (as kwargs) to be passed to the actual plot functions (depends on the backend)</span>
<span class="sd">        :return: ID of the new plot item.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">combineTraces</span> <span class="ow">and</span> <span class="n">join</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">join</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">previousPlotId</span><span class="p">()</span>

        <span class="nb">id</span> <span class="o">=</span> <span class="n">_generate_auto_dict_key</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotItems</span><span class="p">)</span>

        <span class="c1"># TODO: allow any negative number</span>
        <span class="k">if</span> <span class="n">join</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotItems</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">join</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">previousPlotId</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">join</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">join</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">subPlotId</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nSubPlots</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">subPlotId</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotItems</span><span class="p">[</span><span class="n">join</span><span class="p">]</span><span class="o">.</span><span class="n">subPlot</span>

        <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="n">labels</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span>

        <span class="n">plotItem</span> <span class="o">=</span> <span class="n">PlotItem</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="nb">id</span><span class="p">,</span> <span class="n">subPlotId</span><span class="p">,</span>
                            <span class="n">plotDataType</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">plotOptions</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_splitComplexData</span><span class="p">(</span><span class="n">plotItem</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plotItems</span><span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">allPlotIds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plotIds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">id</span></div>

<div class="viewcode-block" id="AutoFigureMaker.previousPlotId"><a class="viewcode-back" href="../../../api/plottr/plot.html#plottr.plot.base.AutoFigureMaker.previousPlotId">[docs]</a>    <span class="k">def</span> <span class="nf">previousPlotId</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get the ID of the most recently added plot item.</span>
<span class="sd">        :return: the ID.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotIds</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotIds</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotIds</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="AutoFigureMaker.findPlotIndexInSubPlot"><a class="viewcode-back" href="../../../api/plottr/plot.html#plottr.plot.base.AutoFigureMaker.findPlotIndexInSubPlot">[docs]</a>    <span class="k">def</span> <span class="nf">findPlotIndexInSubPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plotId</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;find the index of a plot in its subplot</span>

<span class="sd">        :param plotId: plot ID to check</span>
<span class="sd">        :return: index at which the plot is located in its subplot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">plotId</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allPlotIds</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Plot ID not found.&quot;</span><span class="p">)</span>

        <span class="n">subPlotId</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotItems</span><span class="p">[</span><span class="n">plotId</span><span class="p">]</span><span class="o">.</span><span class="n">subPlot</span>
        <span class="n">itemsInSubPlot</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allPlotIds</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotItems</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">subPlot</span> <span class="o">==</span> <span class="n">subPlotId</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">itemsInSubPlot</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">plotId</span><span class="p">)</span></div>

<div class="viewcode-block" id="AutoFigureMaker.plotIdsInSubPlot"><a class="viewcode-back" href="../../../api/plottr/plot.html#plottr.plot.base.AutoFigureMaker.plotIdsInSubPlot">[docs]</a>    <span class="k">def</span> <span class="nf">plotIdsInSubPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subPlotId</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;return all plot IDs in a given subplot</span>

<span class="sd">        :param subPlotId: ID of the subplot</span>
<span class="sd">        :return: list of plot IDs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">itemsInSubPlot</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allPlotIds</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotItems</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">subPlot</span> <span class="o">==</span> <span class="n">subPlotId</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">itemsInSubPlot</span></div>

<div class="viewcode-block" id="AutoFigureMaker.dataDimensionsInSubPlot"><a class="viewcode-back" href="../../../api/plottr/plot.html#plottr.plot.base.AutoFigureMaker.dataDimensionsInSubPlot">[docs]</a>    <span class="k">def</span> <span class="nf">dataDimensionsInSubPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subPlotId</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Determine what the data dimensions are in a subplot.</span>

<span class="sd">        :param subPlotId: ID of the subplot</span>
<span class="sd">        :return: dictionary with plot id as key, data dimension (i.e., number of independents) as value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ret</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">plotId</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotIdsInSubPlot</span><span class="p">(</span><span class="n">subPlotId</span><span class="p">):</span>
            <span class="n">ret</span><span class="p">[</span><span class="n">plotId</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plotItems</span><span class="p">[</span><span class="n">plotId</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">ret</span></div>

    <span class="c1"># Methods to be implemented by inheriting classes</span>
<div class="viewcode-block" id="AutoFigureMaker.makeSubPlots"><a class="viewcode-back" href="../../../api/plottr/plot.html#plottr.plot.base.AutoFigureMaker.makeSubPlots">[docs]</a>    <span class="k">def</span> <span class="nf">makeSubPlots</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nSubPlots</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Generate the subplots. Called after all data has been added.</span>
<span class="sd">        Must be implemented by an inheriting class.</span>

<span class="sd">        :param nSubPlots: number of subplots</span>
<span class="sd">        :return: return values of the subplot generation methods.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

<div class="viewcode-block" id="AutoFigureMaker.formatSubPlot"><a class="viewcode-back" href="../../../api/plottr/plot.html#plottr.plot.base.AutoFigureMaker.formatSubPlot">[docs]</a>    <span class="k">def</span> <span class="nf">formatSubPlot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subPlotId</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Format a subplot.</span>
<span class="sd">        May be implemented by an inheriting class.</span>
<span class="sd">        By default, does nothing.</span>

<span class="sd">        :param subPlotId: ID of the subplot.</span>
<span class="sd">        :return: Depends on inheriting class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="AutoFigureMaker.plot"><a class="viewcode-back" href="../../../api/plottr/plot.html#plottr.plot.base.AutoFigureMaker.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plotItem</span><span class="p">:</span> <span class="n">PlotItem</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Plot an item.</span>
<span class="sd">        Must be implemented by an inheriting class.</span>

<span class="sd">        :param plotItem: the item to plot.</span>
<span class="sd">        :return: Depends on the inheriting class.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span></div></div>


<span class="k">def</span> <span class="nf">_generate_auto_dict_key</span><span class="p">(</span><span class="n">d</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="n">guess</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">guess</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">guess</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">guess</span>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Wolfgang Pfaff, Marcos Frenkel.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>